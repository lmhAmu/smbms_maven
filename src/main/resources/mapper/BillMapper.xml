<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bdqn.mapper.BillMapper">

    <resultMap id="inquireMap" type="com.bdqn.entity.Bill">
        <id property="id" column="id"/>
        <result property="providerId" column="providerId"/>
        <association property="provider"  javaType="com.bdqn.entity.Provider">
            <id property="id" column="p_id"/>
            <result property="proName" column="proName"/>
        </association>
    </resultMap>
    <select id="inquire" resultMap="inquireMap">
        SELECT x.*,y.id as p_id,y.proName FROM smbms_bill X,smbms_provider Y
        <where>
            x.providerId=y.id
            <if test="productName !=null and productName !=''">
                AND x.productName LIKE CONCAT('%',#{productName},'%')
            </if>
            <if test="providerId !=null and providerId !=0">
                AND y.id=#{providerId}
            </if>
            <if test="isPayment !=null and isPayment !=0">
                AND x.isPayment=#{isPayment};
            </if>
            <if test="id !=null and id !=''">
                AND x.id=#{id};
            </if>
        </where>
    </select>

    <update id="update">
        update smbms_bill set billCode=#{billCode},productName=#{productName},productUnit=#{productUnit},productCount=#{productCount},
                              totalPrice=#{totalPrice},isPayment=#{isPayment},providerId=#{providerId}
        where id=#{id}
    </update>
    <insert id="add">
        insert into smbms_bill (billCode,productName,productDesc,productUnit,productCount,totalPrice,isPayment,createdBy,creationDate,modifyBy,modifyDate,providerId)
        values (#{billCode},#{productName},#{productDesc},#{productUnit},#{productCount},
                #{totalPrice},#{isPayment},#{createdBy},#{creationDate},#{modifyBy},#{modifyDate},#{providerId})
    </insert>
    <delete id="delete">
        delete from smbms_bill where id=#{id}
    </delete>
</mapper>